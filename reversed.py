import json
import xml
import os
import xmltodict
import requests
import shutil

PATH = "./images/"

def convert_to_json():
    parsed_data = None
    with open("./images.xml", 'r') as NFILE:
        parsed_data = xmltodict.parse(NFILE.read())
    
    json_data = json.dumps(parsed_data)
    json_parsed = json.loads(json_data)

    file_urls = []
    for cursor in range(30):
        file_urls.append(json_parsed["posts"]["post"][cursor]["@file_url"])
    print(file_urls)
    for images in range(30):
        # print(file_urls[images])
        response = requests.get(file_urls[images], stream=True)
        path = PATH + str(images) + "." +file_urls[images].split(".")[-1]
        path = PATH + (str(file_urls[images]).split("/"))[-1]
        with open(path, 'wb') as out_file:
            shutil.copyfileobj(response.raw, out_file)
        print(path)
    

def Main():
    convert_to_json()
    pass


Main()
